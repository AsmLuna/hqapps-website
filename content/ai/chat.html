---
title: "HQ Chad"
date: 2024-05-07T21:11:22+02:00
draft: false
---

<div class="panel chats-panel">
  <div class="card" onclick="newChat" id="newchat">
    <span>New Chad</span>
  </div>
  <div class="item">
    <span>hi</span>
  </div>
  <div class="item">
    <span>hi</span>
  </div>
</div>

<div class="panel right-panel">
  <div class="model-switcher">
    <!-- Model list dropdown -->
    <div class="model-list">
      <button class="model-switch-button">Switch Model</button>
      <ul class="model-list-dropdown">
        <li data-model="hqchad">
          <span>HQ Chad</span>
          <i class="fas fa-info-circle"></i>
        </li>
        <li data-model="hqchadlite">
          <span>HQ Chad lite</span>
          <i class="fas fa-info-circle"></i>
        </li>
        <li data-model="hqchadpro">
          <span>HQ Chad PRO Ultimate 4090 <br><small style="color: darkgray">Built with Meta Llama 3</small></span>
          <i class="fas fa-info-circle"></i>
        </li>
        <li data-model="meow">
          <span>meow</span>
          <i class="fas fa-info-circle"></i>
        </li>
        <li data-model="hqchadmistral">
          <span>HQ Chad idk</span>
          <i class="fas fa-info-circle"></i>
        </li>
      </ul>
    </div>
    <!-- Current model indicator -->
    <span class="current-model">Current Model: <span class="current-model-name">HQ Chad</span></span>
  </div>
  <div>
    <button class="button-71" onclick="DownloadChatAsFile()">Download Chat File</button>
    <br><br>
    <button class="button-53" onclick="importchatfile()">Import Chat File</button>
  </div>
</div>

<div class="hqaitoolbar">
  <span><b>HQ AI</b></span>
  <span>*</span>
  <li class="aiappstabs">
    <ul class="active"><a href="../chat">Chad</a></ul>
    <ul><a href="../paint">Paint</a></ul>
  </li>
</div>

<div class="chat">
  <div class="mobile-top-bar">
    <button onclick="toggleMobileChatSidebar()"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
    <button onclick="toggleMobileRightSidebar()"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
  </div>
  <div class="messages">
    <div class="chat-info">
      <span>welcom to</span>
      <h2>HQ Chad</h2>
      <p>HQ Chad is the most advanced AI assistant on the market, delivering deep insights and solutions to even the
        most complex queries and needs. Its punctuation errors, capitalization mishaps, and grammatical errors make it
        the perfect assistant for customers who insist on getting it right every time. Send us your queries, we
        guarantee unparalleled intelligence and accuracy.</p>
      <div id="suggestions"></div>
    </div>
  </div>

  <form class="idk">
    <div>
      <input type="text" placeholder="Chatt wiht Smort AI!!" class="messageinput">
      <input type="submit" value="SEND" class="sned">
    </div>
    <span class="disclaimer">You are chatting with AI. It might display inaccurate or offensive information. Fact check
      important information.</span>
  </form>

</div>



<script>

  let HQAImessages = [



  ]

  const messageselm = document.querySelector(".messages")

  let streamSource;
  let streamMsg;
  let streamText = "";
  let streamingrn = false;
  let streaming = true;
  let baseURL = "https://hqapps.org/api/llm"
  let session = ""
  let isNewChat = true
  let currentChatId = crypto.randomUUID()
  let fakeAI = false
  let currentDelete = false
  let chatproduct = "hqchad"
  let chatproducts = {
    hqchad: "HQ Chad",
    hqchadlite: "HQ Chad lite",
    hqchadpro: "HQ Chad Pro Ultra 4090 edition",
    hqchadmistral: "HQ Chad idk",
    meow: "meow"
  }

  let chattitle = ""

  function snedmessage(from, message) {
    const chatinfo = document.querySelector(".chat-info")
    chatinfo.style.display = "none"
    const messageselm = document.querySelector(".messages")
    if(from === "assistant") from = "ai"
    messageselm.innerHTML += `<div class="message from ${from}">
          <div class="message-bubble">
            <span class="msg">
                a
            </span>
            </div>
        </div>`
    const messages = document.querySelectorAll(".message span")
    const last = messages[messages.length - 1]
    console.log(escapeHtml(message))
    last.innerHTML = DOMPurify.sanitize(marked.parse(escapeHtml(message)))
    if (streamingrn) streamMsg = last;
  }

  function snedmessagehtml(from, message) {
    const chatinfo = document.querySelector(".chat-info")
    chatinfo.style.display = "none"
    const messageselm = document.querySelector(".messages")
    messageselm.innerHTML += `<div class="message from ${from}">
          <div class="message-bubble">
            <span class="msg">
                ${message}
            </span>
            </div>
        </div>`;
  }

  const form = document.querySelector(".idk")
  const formInputs = document.querySelectorAll(".idk input")
  function loadmessage() {
    formInputs[0].disabled = true
    formInputs[1].disabled = true

    const message = `<div class="message from ai load">

                <div class="lds-ellipsis"><div></div><div></div><div></div><div></div></div>

        </div>`
    messageselm.innerHTML += message
  }
  function noloadmesage() {
    formInputs[0].disabled = false
    formInputs[1].disabled = false
    document.querySelector(".message.load")?.remove()
  }
  function nocaptchamsg() {
    document.querySelector(".message.captcha")?.remove()
  }
  const messaggeinput = document.querySelector(".messageinput")
  form.addEventListener("submit", e => {
    e.preventDefault()
    if (messaggeinput.value.trim() == "") {
      return
    }
    snedmessage("user", messaggeinput.value)
    loadmessage()
    //doAI(messaggeinput.value)
    doAI(messaggeinput.value).then(a => {
      if (!a) return
      noloadmesage()
      snedmessage("ai", a)
      saveChat()
      loadChatSidebar()
      document.querySelector(`.chats-panel .chat-${currentChatId}`).classList.add("current")
    })
    messaggeinput.value = ""


    /*setTimeout(() => {
        noloadmesage()
        snedmessage("ai", "hi")
    }, 1000)*/


  })

  function doCaptcha() {
    return new Promise((resolve) => {
      noloadmesage()
      snedmessagehtml("ai captcha", `<div id="turnstile-container"></div>`)
      turnstile.render('#turnstile-container', {
        sitekey: '0x4AAAAAAAaUKiQooN03nv_e',
        callback: function (token) {
          resolve(token)
        },
      });
    })
  }

  async function getSession() {
    const captchaToken = await doCaptcha()
    nocaptchamsg()
    loadmessage()
    const response = await fetch(`${baseURL}/registersession?turnstile=${encodeURI(captchaToken)}`)
    const token = await response.text()
    console.log(token)
    session = token
    saveSession()
  }

  async function doAI(message, option) {
    if( !option) option = {}
    let isMessage = true
    let astreaming = streaming
    if(option.askfortitle) {
      isMessage = false
      astreaming = false
      option.product = "hqchadtitle"
    }
    if(fakeAI || chatproduct == "meow") {
      if (isMessage) HQAImessages.push({ "role": "user", "content": message })
      if (isMessage) HQAImessages.push({ "role": "assistant", "content": "meow" })
      if( option.product == "hqchadtitle") return "uwu"
      return "meow"
    }

    if (!session || session.split("_")[0] <= Date.now()) {
      await getSession()
      console.log("captcha done")
    }
    if (!message) return
    console.log(message)

    if (isMessage) HQAImessages.push({ "role": "user", "content": message })

    if (astreaming) {
      streamingrn = true
      streamText = ""
      const streamurl = `${baseURL}?product=${chatproduct}&streaming=true&messages=${encodeURI(JSON.stringify(HQAImessages))}&key=${encodeURI("uwu69owo:3")}&session=${encodeURIComponent(session)}`
      streamSource = new EventSource(streamurl)
      streamSource.addEventListener("message", streamMessage)
      return false
    } else {
      const myHeaders = new Headers();
      myHeaders.append("X-HQ-API-Key", "uwu69owo:3")
      
      const HQAImessageObject = {
        "product": option.product || chatproduct,
        "messages": isMessage ? HQAImessages : [{ "role": "user", "content": message }],
        "session": session
      }
      const response = await fetch(baseURL, {
        method: "POST",
        headers: myHeaders,
        body: JSON.stringify(HQAImessageObject)
      })
      const body = await response.json()
      console.log(body.response.response)
      if (isMessage) HQAImessages.push({ "role": "assistant", "content": body.response.response })
      return body.response.response || "error"
    }
  }

  function streamMessage(event) {
    if (event.data == "[DONE]") {
      streamSource.close();
      streamingrn = false
      streamMsg = null
      streamText = ""
      saveChat()
      loadChatSidebar()
      return;
    }
    const data = JSON.parse(event.data);
    try {
      console.log(JSON.parse(data.response))
      streamText += JSON.parse(data.response).choices[0].delta.content || ""
    } catch {
      streamText += data.response || ""
    }
    
    if (streamMsg) {
      streamMsg.innerHTML = DOMPurify.sanitize(marked.parse(escapeHtml(streamText)))
      HQAImessages[HQAImessages.length-1].content += data.response
    } else {
      noloadmesage()
      snedmessage("ai", data.response || "")
      HQAImessages.push({ "role": "assistant", "content": data.response })
    }
    console.log(data.response)
  }

  function addRandomSuggestions() {
    const suggestionselm = document.querySelector("#suggestions")
    const suggestions = [
      "what skills does the ai have?",
      "can the ai solve complex math problems?",
      "can the ai write english sentences?",
      "does the ai know what animals are in the forest?",
      "can the ai play a sport like cricket or soccer?",
      "can the ai make coffee or tea?",
      "is the ai friendly?",
      "does the ai know when to leave the kitchen?",
      "can the ai cook a meal for you?",
      "can the ai write a research paper on this topic?",
      "can the ai recommend a good book based on my reading preferences?",
      "what are the ai's strengths and weaknesses?",
      "is the ai humorous?",
      "does the ai have a personality?",
      "what's the ai's favorite cat?",
      "is the ai maintenance-free?",
      "does the ai listen to music or podcasts?",
      "where does the ai live?",
      "what's the ai's favorite food?",
      "what's the ai's favorite hobby?"
    ]

    suggestionselm.innerHTML = ""

    for (let i = 0; i < 4; i++) {
      const suggestion = document.createElement("span")
      const thisText = suggestions[Math.floor(Math.random() * suggestions.length)]
      suggestion.innerText = thisText
      suggestion.addEventListener("click", () => insertPrompt(thisText))
      suggestionselm.append(suggestion)
    }

  }

  function insertPrompt(a) {
    messaggeinput.value = a
  }

  function checkiOS(overrideios) {
    const ua = navigator.userAgent
    if (ua.includes("Mac OS X") || overrideios) {
      document.body.style.cssText = "--user-bubble-color: cornflowerblue";
    }
  }

  function saveSession() {
    localStorage.setItem("session", session)
  }

  function loadSession() {
    session = localStorage.getItem("session") || ""
  }

  function newChat(a) {
    if(streamingrn) return
    if(!a) document.querySelector(".chats-panel .current")?.classList.remove("current") || null
    if(!a) document.querySelector(".chats-panel #newchat").classList.add("current")
    HQAImessages = []
    isNewChat = true
    document.querySelectorAll(".message").forEach(e => e.remove())
    const chatinfo = document.querySelector(".chat-info")
    chatinfo.style.display = "flex"
    addRandomSuggestions()
    chattitle = ""
    currentChatId = crypto.randomUUID()
  }

  function loadChat(chat) {
    newChat(true)
    HQAImessages = chat
    chat.forEach(e => snedmessage(e.role, e.content))
  }

  function chatFromLocalStorage(id) {
    document.querySelector(".chats-panel .current")?.classList.remove("current") || null
    document.querySelector(`.chats-panel .chat-${id}`).classList.add("current")
    loadChat(JSON.parse(localStorage.getItem("chat_" + id)))
    currentChatId = id
    chattitle  = localStorage.getItem("name_chat_" + id) || ""
  }

  async function saveChat() {
    localStorage.setItem("chat_" + currentChatId, JSON.stringify(HQAImessages))
    localStorage.setItem("date_chat_" + currentChatId, Date.now())
    loadChatSidebar()
    let name = localStorage.getItem("name_chat_" + currentChatId)
    if(!name) {
      name = await doAI(JSON.stringify(HQAImessages), {askfortitle: true})
      localStorage.setItem("name_chat_" + currentChatId, name)
      chattitle = name
    }
    loadChatSidebar()
    document.querySelector(".chats-panel .current")?.classList.remove("current") || null
    document.querySelector(`.chats-panel .chat-${currentChatId}`).classList.add("current")
  }

  function loadChatSidebar() {
    let all = []
    for ( var i = 0, len = localStorage.length; i < len; ++i ) {
      all.push(localStorage.key( i ))
    }
    all = all.filter(e => e.startsWith("chat_"))
    all = all.sort((a, b) =>
      (localStorage.getItem("date_" + a) || 0) < (localStorage.getItem("date_" + b) || 0)
    )
    //console.log(all)
    const panel = document.querySelector(".chats-panel")
    panel.innerHTML = `
    <div class="card" onclick="newChat()" id="newchat">
    <span>New Chat</span>
  </div>
  ${(() => {
    result = ""
    all.forEach(e => {
      result += `
      <div class="item chat-${e.split("_")[1]}" onclick="chatFromLocalStorage('${e.split("_")[1]}')">
        <div class="title-date">
          <span>${localStorage.getItem(`name_${e}`) || "new chat"}</span>
          <span class="date">${new Date(parseInt(localStorage.getItem(`date_${e}`)) || 0).toLocaleString()}</span>
        </div>
        <button class="delete-button" onclick="startDelete('${e.split("_")[1]}')">deletin</button>
      </div>
      `
    })
    return result
  })()}
    `
  }

  function startDelete(id) {
    currentDelete = id
    confirm("are YOU relly DELET?????") ? doDelete() : null
  }

  function doDelete() {
    localStorage.removeItem("chat_" + currentDelete)
    localStorage.removeItem("name_chat_" + currentDelete)
    if(currentDelete == currentChatId) newChat()
    loadChatSidebar()
    currentDelete = false
  }

  function toggleMobileChatSidebar() {
    document.querySelector(".chats-panel").classList.toggle("mobile-show")
  }
  function toggleMobileRightSidebar() {
    document.querySelector(".right-panel").classList.toggle("mobile-show")
  }

  addRandomSuggestions()
  checkiOS()

  window.onloadTurnstilerReadyCallback = () => {
    console.log("turnstile ready")
  }

  loadSession()
  document.getElementById("newchat").addEventListener("click", newChat)

  loadChatSidebar()
  newChat()

  if (window.location.hostname == "localhost" || window.location.hostname == "127.0.0.1") {
    fakeAI = true
  }

  // Get the model list dropdown and button elements
const modelListDropdown = document.querySelector('.model-list-dropdown');
const modelSwitchButton = document.querySelector('.model-switch-button');

// Get the current model indicator element
const currentModelIndicator = document.querySelector('.current-model-name');

// Add event listener to the model switch button
modelSwitchButton.addEventListener('click', () => {
  // Toggle the model list dropdown
  modelListDropdown.classList.toggle('show');
});

// Add event listeners to the model list items
document.querySelectorAll('.model-list-dropdown li').forEach((item) => {
  item.addEventListener('click', (event) => {
    // Get the selected model
    const targetLi = event.target.closest('li');
    const selectedModel = targetLi.dataset.model;

    
    console.log(JSON.stringify(event.target.dataset))

    // Update the current model indicator
    currentModelIndicator.textContent = chatproducts[selectedModel];

    // Hide the model list dropdown
    modelListDropdown.classList.remove('show');

    // Call the API to switch to the selected model (not implemented in this example)
    // ...
    chatproduct = selectedModel
  });
});

function escapeHtml(unsafe) {
  let result = '';
  let inCodeBlock = false;
  let codeBlockDelimiter = '';

  for (let i = 0; i < unsafe.length; i++) {
    if (unsafe.substring(i, i + 3) === '```' && !inCodeBlock) {
      result += '```';
      inCodeBlock = true;
      codeBlockDelimiter = '```';
    } else if (unsafe.substring(i, i + 1) === '`' && !inCodeBlock) {
      result += '`';
      inCodeBlock = true;
      codeBlockDelimiter = '`';
    } else if (inCodeBlock) {
      if (codeBlockDelimiter === '```' && unsafe.substring(i, i + 3) === '```') {
        result += '```';
        inCodeBlock = false;
      } else if (codeBlockDelimiter === '`' && unsafe.substring(i, i + 1) === '`') {
        result += '`';
        inCodeBlock = false;
      } else {
        result += unsafe.substring(i, i + 1);
      }
    } else {
      if (unsafe.substring(i, i + 1) === '&') {
        result += "&amp;";
      } else if (unsafe.substring(i, i + 1) === '<') {
        result += "&lt;";
      } else if (unsafe.substring(i, i + 1) === '>') {
        result += "&gt;";
      } else if (unsafe.substring(i, i + 1) === '"') {
        result += "&quot;";
      } else if (unsafe.substring(i, i + 1) === "'") {
        result += "&#039;";
      } else {
        result += unsafe.substring(i, i + 1);
      }
    }
  }

  return result;
}





function DownloadChatAsFile() {
  const filecontent = {
    "version": "1",
    "type": "hqchadchat",
    "title": chattitle || "new chat",
    "chat": HQAImessages
  }
  const filename = chattitle.replace(/[\W]+/g,"-") || "conversation";
  const link = document.createElement("a")
  link.download = `${filename}-${Date.now()}.hqchat`
  link.href = `data:application/json,${encodeURIComponent(JSON.stringify(filecontent))}`
  link.click()
}

function importchatfile() {
  const fileinput = document.createElement("input")
  fileinput.type = "file"
  fileinput.addEventListener("change", e => {
    var file = e.target.files[0];
    if (!file) {
      return;
    }
    var reader = new FileReader();
    reader.addEventListener("load", e => {
      const contents = e.target.result
      const jsonContent = JSON.parse(contents)
      if(!jsonContent) {
        alert("invalid file error issue")
        return
      }
      if(jsonContent.chat == [] || !jsonContent.chat) {
        alert("empty chat")
        return
      }
      const importid = crypto.randomUUID()
      localStorage.setItem("chat_" + importid, JSON.stringify(jsonContent.chat))
      localStorage.setItem("name_chat_" + importid, jsonContent.title || "new chat")
      localStorage.setItem("date_chat_" + importid, Date.now())
      loadChatSidebar()
      console.log(jsonContent)
    })
    reader.readAsText(file);

  }) 
  fileinput.click()
}


</script>

<style>
  @import url("./style.css");
</style>

<script src="https://challenges.cloudflare.com/turnstile/v0/api.js?onload=onloadTurnstilerReadyCallback"></script>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/cure53/DOMPurify@3.1.5/dist/purify.min.js"></script>
